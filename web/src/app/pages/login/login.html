<div
  class="from-primary-hover/30 via-accent/30 to-accent-hover/20 flex min-h-screen items-center justify-center bg-gradient-to-br p-4">
  <div class="bg-bg w-full max-w-md rounded-2xl p-6 shadow-lg">
    <div class="mb-4 space-y-2 text-center">
      <div
        class="border-primary animate-slide-up shadow-primary-md m-auto mb-4 aspect-square w-fit rounded-full border-[1rem]">
        <div class="aspect-square h-12 rounded-full border-4 border-black"></div>
      </div>

      <h1 class="text-primary text-3xl font-bold">Kogui Pokédex</h1>

      <p class="text-muted text-sm">Entre com suas credenciais para acessar</p>
    </div>

    <form (submit)="handleLogin($event)" class="" novalidate>
      @if (generalError) {
      <div
        class="mb-4 rounded-xl bg-red-50 border border-red-200 p-3 text-sm text-red-700 animate-slide-up flex items-center gap-2">
        <i-lucide [img]="AlertCircleIcon" size="16" class="text-red-500"></i-lucide>
        <span>{{ generalError }}</span>
      </div>
      }

      <div class="mb-4">
        <label for="email" class="flex flex-col text-sm font-semibold">E-mail</label>
        <div class="relative mt-2">
          <input id="email" type="email" class="w-full rounded-xl border px-3 py-3 text-xs transition-all duration-200"
            placeholder="seu@email.com" [(ngModel)]="email" name="email" required (blur)="validateEmail()"
            (input)="clearGeneralError(); emailTouched && validateEmail()" />

          @if (emailTouched) {
          <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
            @if (emailError) {
            <i-lucide [img]="AlertCircleIcon" size="16" class="text-red-500"></i-lucide>
            } @else if (emailValid) {
            <i-lucide [img]="CheckCircleIcon" size="16" class="text-green-500"></i-lucide>
            }
          </div>
          }
        </div>

        @if (emailError && emailTouched) {
        <p class="mt-1 text-xs text-red-600 animate-slide-up flex items-center gap-1">
          <i-lucide [img]="AlertCircleIcon" size="12"></i-lucide>
          {{ emailError }}
        </p>
        }
      </div>

      <div class="mb-4">
        <label for="password" class="flex flex-col text-sm font-semibold">Senha</label>
        <div class="relative mt-2">
          <input id="password" type="password"
            class="w-full rounded-xl border px-3 py-3 text-xs transition-all duration-200" placeholder="••••••••"
            [(ngModel)]="password" name="password" required (blur)="validatePassword()" placeholder="••••••••"
            (input)="clearGeneralError(); passwordTouched && validatePassword()" />

          @if (passwordTouched) {
          <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
            @if (passwordError) {
            <i-lucide [img]="AlertCircleIcon" size="16" class="text-red-500"></i-lucide>
            } @else if (passwordValid) {
            <i-lucide [img]="CheckCircleIcon" size="16" class="text-green-500"></i-lucide>
            }
          </div>
          }
        </div>

        @if (passwordError && passwordTouched) {
        <p class="mt-1 text-xs text-red-600 animate-slide-up flex items-center gap-1">
          <i-lucide [img]="AlertCircleIcon" size="12"></i-lucide>
          {{ passwordError }}
        </p>
        }
      </div>

      <div class="mb-4 flex w-full justify-end">
        <a routerLink="/forgot-password" class="text-primary w-full cursor-pointer text-end text-sm hover:underline">
          Esqueci minha senha
        </a>
      </div>

      <button type="submit"
        class="mt-4 w-full bg-primary hover:bg-primary-hover rounded-xl px-4 py-3 text-white font-medium transition-all duration-200 flex items-center justify-center gap-2"
        [disabled]="loading">
        @if (loading) {
        <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
        <span>Entrando...</span>
        } @else {
        <span>{{ isFormValid() ? 'Entrar' : 'Preencha os campos' }}</span>
        }
      </button>

      <div class="text-muted mt-4 flex items-center justify-center space-x-2 text-sm">
        <span class="">Não tem uma conta? </span>
        <a routerLink="/register" class="text-primary cursor-pointer hover:underline">
          Criar conta
        </a>
      </div>
    </form>
  </div>
</div>

<!-- Toast Container -->
<sc-angular-toastify></sc-angular-toastify>